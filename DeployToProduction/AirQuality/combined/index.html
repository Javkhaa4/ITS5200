<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
  <script src="./combined.js"></script>
  
    <style>
  body {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
  }

  #container {
    text-align: center;
  }

  table, th, td {
    border: 1px solid;
    margin: 10px;
  }

  h1 {
    color: black;
  }

  input {
    margin: 5px;
  }
</style>
</head>
<body>

  <h1> Air Quality Index Calculator </h1>

  <div id="page1">
    <div id="boxes1">
      <input type="text" id="box1" value="96.83"> Particulate Matter 2.5 (PM2.5) <br/>
      <input type="text" id="box2" value="139.36"> articulate Matter 10 (PM10) <br/>
      <input type="text" id="box3" value="1.6"> Nitrogen Monoxide (NO)  <br/>
      <input type="text" id="box4" value="25.65"> Nitrogen Dioxide (NO2) <br/>
      <input type="text" id="box5" value="14.99" > Nitrogen X (NOx) <br/>
      <input type="text" id="box6" value="15.12"> Ammonia (NH3) <br/>
      <input type="text" id="box7" value="0.11"> Carbon Monoxide (CO) <br/>
      <input type="text" id="box8" value="16.54"> Sulfur Dioxide (SO2) <br/>
      <input type="text" id="box9" value="117.21"> Ground-Level Ozone (O3) <br/>
      <input type="text" id="box10" value="0.29" > Benzene <br/>
      <input type="text" id="box11" value="4.45"> Toluene <br/>
      <input type="text" id="box12" value="0.07"> Xylene <br/>
    </div>

    <div>
      <input type="button" value="Calculate" onclick="runExample1()"/>
    </div>

    <div id="predictions1">
      <h2> Air Quality Index (AQI) </h2>
    </div>
  </div>

  <hr>

  <div id="page2">
    <div id="boxes2">
      <input type="text" id="box1_page2" value=""> Air Quality Index <br/>
    </div>

    <div>
      <input type="button" value="Calculate" onclick="runExample2()"/>
    </div>

    <div id="predictions2">
      <h2> AQI Bucket </h2>
    </div>
  </div>

  <script>
    async function runExample1() {
      var x = new Float32Array(12);

      x[0] = parseFloat(document.getElementById('box1').value);
      x[1] = parseFloat(document.getElementById('box2').value);
      x[2] = parseFloat(document.getElementById('box3').value);
      x[3] = parseFloat(document.getElementById('box4').value);
      x[4] = parseFloat(document.getElementById('box5').value);
      x[5] = parseFloat(document.getElementById('box6').value);
      x[6] = parseFloat(document.getElementById('box7').value);
      x[7] = parseFloat(document.getElementById('box8').value);
      x[8] = parseFloat(document.getElementById('box9').value);
      x[9] = parseFloat(document.getElementById('box10').value);
      x[10] = parseFloat(document.getElementById('box11').value);
      x[11] = parseFloat(document.getElementById('box12').value);

      let tensorX = new ort.Tensor('float32', x, [1, 12]);
      let feeds = { float_input: tensorX };

      let session = await ort.InferenceSession.create('xgboost_AirQuality_ort.onnx');
      let result = await session.run(feeds);
      let outputData = parseFloat(result.variable.data).toFixed(2);

      // Show the predicted AQI on the first page
      let predictions1 = document.getElementById('predictions1');
      predictions1.innerHTML = `<hr>Air Quality by Index <br/>
        <table>
          <tr>
            <td>AQI</td>
            <td id="td0">${outputData}</td>
          </tr>
        </table>`;

      // Automatically populate input on page 2 with predicted AQI from page 1
      document.getElementById('box1_page2').value = outputData;
    }

    async function runExample2() {
      var x = new Float32Array(1);
      x[0] = parseFloat(document.getElementById('box1_page2').value);

      let tensorX = new ort.Tensor('float32', x, [1, 1]);
      let feeds = { float_input: tensorX };

      let session = await ort.InferenceSession.create('xgboost_Classification_AirQuality_ort.onnx');
      let result = await session.run(feeds);
      let outputData = parseFloat(result.variable.data).toFixed(2);

      // Show the predicted AQI on the second page
      let predictions2 = document.getElementById('predictions2');
      predictions2.innerHTML = `<hr>Air Quality by feeling <br/>
        <table>
          <tr>
            <td>AQI Bucket</td>
            <td id="td0">${outputData}</td>
          </tr>
        </table>`;
    }
  </script>
</body>
</html>
